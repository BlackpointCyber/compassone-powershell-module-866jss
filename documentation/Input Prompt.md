```
## Vision & Purpose

Blackpoint has developed a revolutionary cyber security platform called CompassOne. This platform analyzes and improves a business' cyber security posture through preventative and reactive actions. It generates a security posture score for each business and consists of various modules based on the business' CompassOne subscription. Modules include asset inventory, security posture graph, detection and response (which includes a 24/7 Managed security service provided by Blackpoint's human-staffed security operations center [SOC]), exposure prioritization, compliance, and tenant management (which supports customer settings as well as multi-tenant manager for IT service providers who use CompassOne to help protect all their managed end customers).

The CompassOne platform runs on a complex set of micro-services, data platforms, and data stores. In addition to a modern, React-based Web frontend, the CompassOne platform also offers a publicly accessible REST-based API. This API allows Blackpoint customers as well as Blackpoint vendor and technology partners to engage with the CompassOne platform programmatically. In addition to supporting a standard set of CRUD (Create, Read, Update, and Delete) operations on entities and objects within the CompassOne platform, the API also supports more complex operations like fetching events related to a security incident or managing tags on data objects within the platform.

To support adoption and utilization of this public CompassOne API, Blackpoint will provide various CLIs and SDKs in different languages and technologies to customers and partners.

The goal of this project is to build a Microsoft PowerShell Module that allows PowerShell users to directly interact with the CompassOne public API endpoints using a native PowerShell Module instead of having to build custom logic to contact these APIs.

Existing CLIs and SDKs already exist for Node/Javascript and Python. This PowerShell Module should work seamlessly in PowerShell and follow standard PowerShell module best practices, patterns, and constructs.

## Core Requirements

### Functional Requirements

* The module shall operate similar to a CLI but as a standard Microsoft PowerShell module
* The module shall be installed via the PowerShell Gallery or directly from Github
* The module shall allow users to enter a command to return the current version of the Module
* The module shall allow users use PowerShell's Get-Help command to get help information about a specifc module command, e.g. `Get-Help Get-Asset`
* The module shall include commands for the following CRAFT service objects: assets, findings, incidents, relationships, and tags.
* The module shall include commands that match the REST API methods for each of the CRAFT service objects based on the API swagger spec.
* The module shall support paging and sorting for those REST API methods that support these features as defined in the API swagger spec.
* The module shall support the user providing the API url and access token as part of the command execution or extract them from defined env variables (COMPASSONE_API_URL) and (COMPASSONE_API_TOKEN). The module should use these values if they are passed in along with the commands; otherwise fall back the env variables if they are defined. If values are not provided along with the command or present in the env variables, an error should be present.
* The module shall use the Microsoft.PowerShell.SecretStore to store URL and token if the user would prefer to define the URL and token and persist them instead of using the env variables or providing them on the command line.
* The module shall print out the help syntax for each command if the command syntax is not correct or errors occur.
* The module shall print out human readable and useful error messages if an invocation of the PowerShell module has errors.
* The project shall include extensive README documentation on how to use the PowerShell module including how to configure authentication and configuration, how to get help, and how to execute the various commands for the CRAFT service objects.
* The module needs to support accepting configuration information: **url** which is the root URL for API endpoints, and **token**, which is the authorization token for the API service. This token will be passed in an HTTP header for all requests with a header key of "key: <token>"
* The module shall output API results to the command line output. 
* The module shall support an optional flag/switch called "pretty-print" that nicely styles API result output. If the API response is an array of objects, the objects should be printed out in a table view. If the API response is a JSON object, it should be printed out in a nicely formatted, tab-indented, and new-lined format. If the "pretty-print" flag is not present, then the results should just be sent to the console output as regular JSON.
* The module shall accept JSON strings or a filepath to a valid JSON file as an input to PowerShell commands that call API methods that accept data objects (typically API POST and API PUT methods).
* The module shall call CompassOne API methods with headers of: Content-Type: `application/json`, and Accept: `application/json`. The overall header structure for the REST API calls will be:
```json
    "headers": {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        key: `${config.apiKey}`,
    }
```

## Planning & Implementation

### Technical Implementation

**Required Stack Components**

* PowerShell Module (written in PowerShell files // C#)
* Unit tests testing with 100% code coverage
* Linting and styling libraries or rules

**System Requirements**

* Module should be capable of being installed like other PowerShell modules
* Module should be performant on a typical PC that has PowerShell installed
* Module should be named "PSCompassOne"

### User Experience

**Key User Flows**

\*1. Setting up configuration
a. User sets up using Microsoft.PowerShell.SecretStore
b. User provides configuration during command invocation of the module using switches -u (for url) and -t (for token) \[or if it's more standard with PowerShell modules to use --url (for url) and --token (for token)
c. User provides configuration by setting system env variables COMPASSONE_API_URL (for url) and COMPASSONE_API_TOKEN (for token)

\*2. Finding all available commands
a. User should be able to run: Get-Command -Module PSCompassOne
b. All available commands (high-level) will be printed to console
c. User should be able to run Get-Command -Module PSCompassOne

\*3. Running a command
a. User should be able to run a command from the module: Assets-Get

### Business Requirements

**Access & Authentication**

* Users will authenticate to the CompassOne API using a `key` that they obtain from other sources

**Business Rules**

### Implementation Priorities

* High Priority: CompassOne Module with all required features
* Medium Priority: Unit tests with 100% code coverage
* Lower Priority: Documentation that matches functionality of PowerShell Module
* Lowest Priority: Linting and styling rules that can be run over the source code and tests to ensure common formatting and styling based on PowerShell standards

```

Here is the current Swagger spec for the CRAFT service:
```

{ "openapi": "3.0.0", "paths": { "/v1/assets": { "post": { "operationId": "AssetController_create", "summary": "", "description": "Create an asset of a given class", "parameters": \[\], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateAssetRequestBodyDto" } } } }, "responses": { "201": { "description": "", "content": { "application/json": { "schema": { "discriminator": { "mapping": { "CONTAINER": "#/components/schemas/ContainerResponseDto", "DEVICE": "#/components/schemas/DeviceResponseDto", "FRAMEWORK": "#/components/schemas/FrameworkResponseDto", "NETSTAT": "#/components/schemas/NetstatResponseDto", "PERSON": "#/components/schemas/PersonResponseDto", "PROCESS": "#/components/schemas/ProcessResponseDto", "SERVICE": "#/components/schemas/ServiceResponseDto", "SOFTWARE": "#/components/schemas/SoftwareResponseDto", "SOURCE": "#/components/schemas/SourceResponseDto", "SURVEY": "#/components/schemas/SurveyResponseDto", "USER": "#/components/schemas/UserResponseDto" }, "propertyName": "assetClass" }, "oneOf": \[ { "$ref": "#/components/schemas/ContainerResponseDto" }, { "$ref": "#/components/schemas/DeviceResponseDto" }, { "$ref": "#/components/schemas/FrameworkResponseDto" }, { "$ref": "#/components/schemas/NetstatResponseDto" }, { "$ref": "#/components/schemas/PersonResponseDto" }, { "$ref": "#/components/schemas/ProcessResponseDto" }, { "$ref": "#/components/schemas/ServiceResponseDto" }, { "$ref": "#/components/schemas/SoftwareResponseDto" }, { "$ref": "#/components/schemas/SourceResponseDto" }, { "$ref": "#/components/schemas/SurveyResponseDto" }, { "$ref": "#/components/schemas/UserResponseDto" } \], "title": "AssetResponseDto" } } } } }, "tags": \[ "asset" \] }, "get": { "operationId": "AssetController_list", "summary": "", "description": "Get a list of assets of a given class", "parameters": \[ { "name": "pageSize", "required": false, "in": "query", "description": "Max number of items to return from the database", "schema": { "default": 50, "type": "number" } }, { "name": "page", "required": false, "in": "query", "description": "Number of database items to skip", "schema": { "default": 1, "type": "number" } }, { "name": "sortBy", "required": false, "in": "query", "schema": { "default": "name", "enum": \[ "assetClass", "classification", "criticality", "foundOn", "id", "lastSeenOn", "name", "status" \], "type": "string" } }, { "name": "sortOrder", "required": false, "in": "query", "schema": { "$ref": "#/components/schemas/OrderDirection" } }, { "name": "withDeleted", "required": false, "in": "query", "schema": { "default": false, "type": "boolean" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListAssetsPaginatedResponseDto" } } } } }, "tags": \[ "asset" \] } }, "/v1/assets/{id}": { "get": { "operationId": "AssetController_get", "summary": "", "description": "Get a single asset of a given class", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "discriminator": { "mapping": { "CONTAINER": "#/components/schemas/ContainerResponseDto", "DEVICE": "#/components/schemas/DeviceResponseDto", "FRAMEWORK": "#/components/schemas/FrameworkResponseDto", "NETSTAT": "#/components/schemas/NetstatResponseDto", "PERSON": "#/components/schemas/PersonResponseDto", "PROCESS": "#/components/schemas/ProcessResponseDto", "SERVICE": "#/components/schemas/ServiceResponseDto", "SOFTWARE": "#/components/schemas/SoftwareResponseDto", "SOURCE": "#/components/schemas/SourceResponseDto", "SURVEY": "#/components/schemas/SurveyResponseDto", "USER": "#/components/schemas/UserResponseDto" }, "propertyName": "assetClass" }, "oneOf": \[ { "$ref": "#/components/schemas/ContainerResponseDto" }, { "$ref": "#/components/schemas/DeviceResponseDto" }, { "$ref": "#/components/schemas/FrameworkResponseDto" }, { "$ref": "#/components/schemas/NetstatResponseDto" }, { "$ref": "#/components/schemas/PersonResponseDto" }, { "$ref": "#/components/schemas/ProcessResponseDto" }, { "$ref": "#/components/schemas/ServiceResponseDto" }, { "$ref": "#/components/schemas/SoftwareResponseDto" }, { "$ref": "#/components/schemas/SourceResponseDto" }, { "$ref": "#/components/schemas/SurveyResponseDto" }, { "$ref": "#/components/schemas/UserResponseDto" } \], "title": "AssetResponseDto" } } } } }, "tags": \[ "asset" \] }, "patch": { "operationId": "AssetController_update", "summary": "", "description": "Update an asset of a given class", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UpdateAssetRequestBodyDto" } } } }, "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "discriminator": { "mapping": { "CONTAINER": "#/components/schemas/ContainerResponseDto", "DEVICE": "#/components/schemas/DeviceResponseDto", "FRAMEWORK": "#/components/schemas/FrameworkResponseDto", "NETSTAT": "#/components/schemas/NetstatResponseDto", "PERSON": "#/components/schemas/PersonResponseDto", "PROCESS": "#/components/schemas/ProcessResponseDto", "SERVICE": "#/components/schemas/ServiceResponseDto", "SOFTWARE": "#/components/schemas/SoftwareResponseDto", "SOURCE": "#/components/schemas/SourceResponseDto", "SURVEY": "#/components/schemas/SurveyResponseDto", "USER": "#/components/schemas/UserResponseDto" }, "propertyName": "assetClass" }, "oneOf": \[ { "$ref": "#/components/schemas/ContainerResponseDto" }, { "$ref": "#/components/schemas/DeviceResponseDto" }, { "$ref": "#/components/schemas/FrameworkResponseDto" }, { "$ref": "#/components/schemas/NetstatResponseDto" }, { "$ref": "#/components/schemas/PersonResponseDto" }, { "$ref": "#/components/schemas/ProcessResponseDto" }, { "$ref": "#/components/schemas/ServiceResponseDto" }, { "$ref": "#/components/schemas/SoftwareResponseDto" }, { "$ref": "#/components/schemas/SourceResponseDto" }, { "$ref": "#/components/schemas/SurveyResponseDto" }, { "$ref": "#/components/schemas/UserResponseDto" } \], "title": "AssetResponseDto" } } } } }, "tags": \[ "asset" \] }, "delete": { "operationId": "AssetController_delete", "summary": "", "description": "Soft deletes an asset of a given class", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "204": { "description": "" } }, "tags": \[ "asset" \] } }, "/v1/assets/{id}/tags": { "put": { "operationId": "AssetController_replaceTags", "summary": "", "description": "Replace all tags assigned to an asset", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AssignTagsToAssetsRequestBodyDto" } } } }, "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "discriminator": { "mapping": { "CONTAINER": "#/components/schemas/ContainerResponseDto", "DEVICE": "#/components/schemas/DeviceResponseDto", "FRAMEWORK": "#/components/schemas/FrameworkResponseDto", "NETSTAT": "#/components/schemas/NetstatResponseDto", "PERSON": "#/components/schemas/PersonResponseDto", "PROCESS": "#/components/schemas/ProcessResponseDto", "SERVICE": "#/components/schemas/ServiceResponseDto", "SOFTWARE": "#/components/schemas/SoftwareResponseDto", "SOURCE": "#/components/schemas/SourceResponseDto", "SURVEY": "#/components/schemas/SurveyResponseDto", "USER": "#/components/schemas/UserResponseDto" }, "propertyName": "assetClass" }, "oneOf": \[ { "$ref": "#/components/schemas/ContainerResponseDto" }, { "$ref": "#/components/schemas/DeviceResponseDto" }, { "$ref": "#/components/schemas/FrameworkResponseDto" }, { "$ref": "#/components/schemas/NetstatResponseDto" }, { "$ref": "#/components/schemas/PersonResponseDto" }, { "$ref": "#/components/schemas/ProcessResponseDto" }, { "$ref": "#/components/schemas/ServiceResponseDto" }, { "$ref": "#/components/schemas/SoftwareResponseDto" }, { "$ref": "#/components/schemas/SourceResponseDto" }, { "$ref": "#/components/schemas/SurveyResponseDto" }, { "$ref": "#/components/schemas/UserResponseDto" } \], "title": "AssetResponseDto" } } } } }, "tags": \[ "asset" \] } }, "/v1/findings": { "post": { "operationId": "FindingController_create", "summary": "", "description": "Create a finding of a given class", "parameters": \[\], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateFindingRequestBodyDto" } } } }, "responses": { "201": { "description": "", "content": { "application/json": { "schema": { "discriminator": { "mapping": { "ALERT": "#/components/schemas/AlertResponseDto", "EVENT": "#/components/schemas/EventResponseDto", "INCIDENT": "#/components/schemas/IncidentResponseDto" }, "propertyName": "findingClass" }, "oneOf": \[ { "$ref": "#/components/schemas/AlertResponseDto" }, { "$ref": "#/components/schemas/EventResponseDto" }, { "$ref": "#/components/schemas/IncidentResponseDto" } \], "title": "FindingResponseDto" } } } } }, "tags": \[ "finding" \] }, "get": { "operationId": "FindingController_list", "summary": "", "description": "Get a list of findings of a given class", "parameters": \[ { "name": "pageSize", "required": false, "in": "query", "description": "Max number of items to return from the database", "schema": { "default": 50, "type": "number" } }, { "name": "page", "required": false, "in": "query", "description": "Number of database items to skip", "schema": { "default": 1, "type": "number" } }, { "name": "sortBy", "required": false, "in": "query", "schema": { "default": "name", "enum": \[ "findingClass", "classification", "criticality", "foundOn", "id", "lastSeenOn", "name", "status" \], "type": "string" } }, { "name": "sortOrder", "required": false, "in": "query", "schema": { "$ref": "#/components/schemas/OrderDirection" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListFindingsPaginatedResponseDto" } } } } }, "tags": \[ "finding" \] } }, "/v1/findings/{id}": { "patch": { "operationId": "FindingController_update", "summary": "", "description": "Update a finding of a given class", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UpdateFindingRequestBodyDto" } } } }, "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "discriminator": { "mapping": { "ALERT": "#/components/schemas/AlertResponseDto", "EVENT": "#/components/schemas/EventResponseDto", "INCIDENT": "#/components/schemas/IncidentResponseDto" }, "propertyName": "findingClass" }, "oneOf": \[ { "$ref": "#/components/schemas/AlertResponseDto" }, { "$ref": "#/components/schemas/EventResponseDto" }, { "$ref": "#/components/schemas/IncidentResponseDto" } \], "title": "FindingResponseDto" } } } } }, "tags": \[ "finding" \] }, "get": { "operationId": "FindingController_get", "summary": "", "description": "Get a single finding of a given class", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "discriminator": { "mapping": { "ALERT": "#/components/schemas/AlertResponseDto", "EVENT": "#/components/schemas/EventResponseDto", "INCIDENT": "#/components/schemas/IncidentResponseDto" }, "propertyName": "findingClass" }, "oneOf": \[ { "$ref": "#/components/schemas/AlertResponseDto" }, { "$ref": "#/components/schemas/EventResponseDto" }, { "$ref": "#/components/schemas/IncidentResponseDto" } \], "title": "FindingResponseDto" } } } } }, "tags": \[ "finding" \] }, "delete": { "operationId": "FindingController_delete", "summary": "", "description": "Soft deletes a finding of a given class", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "204": { "description": "" } }, "tags": \[ "finding" \] } }, "/v1/incidents/{id}": { "get": { "operationId": "IncidentController_get", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/IncidentResponseDto" } } } } }, "tags": \[ "incident" \] }, "patch": { "operationId": "IncidentController_update", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UpdateIncidentRequestBodyDto" } } } }, "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/IncidentResponseDto" } } } } }, "tags": \[ "incident" \] }, "delete": { "operationId": "IncidentController_delete", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "200": { "description": "" } }, "tags": \[ "incident" \] } }, "/v1/incidents": { "get": { "operationId": "IncidentController_list", "parameters": \[ { "name": "pageSize", "required": false, "in": "query", "description": "Max number of items to return from the database", "schema": { "default": 50, "type": "number" } }, { "name": "page", "required": false, "in": "query", "description": "Number of database items to skip", "schema": { "default": 1, "type": "number" } }, { "name": "search", "required": false, "in": "query", "description": "Search string to query on all data from incidents", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListIncidentsPaginatedResponseDto" } } } } }, "tags": \[ "incident" \] }, "post": { "operationId": "IncidentController_create", "parameters": \[\], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateIncidentRequestBodyDto" } } } }, "responses": { "201": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/IncidentResponseDto" } } } } }, "tags": \[ "incident" \] } }, "/v1/relationships": { "post": { "operationId": "RelationshipController_createRelationship", "parameters": \[\], "requestBody": { "required": true, "description": "The relationship to create.", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipCreateRequestDto" } } } }, "responses": { "201": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipReadResponseWithRelatedDto" } } } }, "400": { "description": "The server could not understand the request due to invalid syntax." }, "401": { "description": "Access to the resource is unauthorized." }, "403": { "description": "Access to the resource is forbidden." }, "404": { "description": "Resource not found." }, "429": { "description": "Returned when the rate limit has been exceeded." }, "500": { "description": "Returned when a server operation fails in an unexpected way." }, "503": { "description": "Returned when the service is temporarily or expectedly unavailable." }, "default": { "description": "The relationship that was created, along with related data.", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipReadResponseWithRelatedDto" } } } } }, "tags": \[ "relationship" \] } }, "/v1/relationships/{id}": { "get": { "operationId": "RelationshipController_getRelationship", "parameters": \[ { "name": "id", "required": true, "in": "path", "description": "The id of the relationship to retrieve.", "schema": { "format": "uuid", "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipReadResponseWithRelatedDto" } } } }, "400": { "description": "The server could not understand the request due to invalid syntax." }, "401": { "description": "Access to the resource is unauthorized." }, "403": { "description": "Access to the resource is forbidden." }, "404": { "description": "Resource not found." }, "429": { "description": "Returned when the rate limit has been exceeded." }, "500": { "description": "Returned when a server operation fails in an unexpected way." }, "503": { "description": "Returned when the service is temporarily or expectedly unavailable." }, "default": { "description": "The relationship with the given id.", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipReadResponseWithRelatedDto" } } } } }, "tags": \[ "relationship" \] }, "patch": { "operationId": "RelationshipController_updateRelationship", "parameters": \[ { "name": "id", "required": true, "in": "path", "description": "The id of the entity to update.", "schema": { "format": "uuid", "type": "string" } } \], "requestBody": { "required": true, "description": "The updates to the relationship entity", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipUpdateRequestDto" } } } }, "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipReadResponseWithRelatedDto" } } } }, "400": { "description": "The server could not understand the request due to invalid syntax." }, "401": { "description": "Access to the resource is unauthorized." }, "403": { "description": "Access to the resource is forbidden." }, "404": { "description": "Resource not found." }, "429": { "description": "Returned when the rate limit has been exceeded." }, "500": { "description": "Returned when a server operation fails in an unexpected way." }, "503": { "description": "Returned when the service is temporarily or expectedly unavailable." }, "default": { "description": "The relationship that was updated, along with related data.", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipReadResponseWithRelatedDto" } } } } }, "tags": \[ "relationship" \] }, "delete": { "operationId": "RelationshipController_deleteRelationship", "parameters": \[ { "name": "id", "required": true, "in": "path", "description": "The id of the entity to delete.", "schema": { "format": "uuid", "type": "string" } } \], "requestBody": { "required": true, "description": "The delete information for the relationship entity", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/RelationshipDeleteRequestDto" } } } }, "responses": { "204": { "description": "Returned when the entity is deleted successfully" }, "400": { "description": "The server could not understand the request due to invalid syntax." }, "401": { "description": "Access to the resource is unauthorized." }, "403": { "description": "Access to the resource is forbidden." }, "404": { "description": "Resource not found." }, "429": { "description": "Returned when the rate limit has been exceeded." }, "500": { "description": "Returned when a server operation fails in an unexpected way." }, "503": { "description": "Returned when the service is temporarily or expectedly unavailable." } }, "tags": \[ "relationship" \] } }, "/v1/relationships/asset/{id}/entities": { "get": { "operationId": "RelationshipController_listEntitiesRelatedToAsset", "parameters": \[ { "name": "id", "required": true, "in": "path", "description": "The id of the asset to retrieve related entities for.", "schema": { "format": "uuid", "type": "string" } }, { "name": "pageSize", "required": false, "in": "query", "description": "Max number of items to return from the database", "schema": { "default": 50, "type": "number" } }, { "name": "page", "required": false, "in": "query", "description": "Number of database items to skip", "schema": { "default": 1, "type": "number" } }, { "name": "sortBy", "required": false, "in": "query", "schema": { "default": "name", "enum": \[ "classification", "criticality", "display_name", "foundOn", "id", "lastSeenOn", "model", "name", "status", "type" \], "type": "string" } }, { "name": "sortOrder", "required": false, "in": "query", "schema": { "$ref": "#/components/schemas/OrderDirection" } }, { "name": "direction", "required": true, "in": "query", "schema": { "enum": \[ "in", "out" \], "type": "string" } }, { "name": "model", "required": false, "in": "query", "schema": { "enum": \[ "ASSET", "FINDING" \], "type": "string" } }, { "name": "class", "required": false, "in": "query", "schema": { "enum": \[ "CONTAINER", "DEVICE", "FRAMEWORK", "NETSTAT", "PERSON", "PROCESS", "SERVICE", "SOFTWARE", "SOURCE", "SURVEY", "USER", "ALERT", "EVENT", "INCIDENT" \], "type": "string" } }, { "name": "type", "required": false, "in": "query", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListAssetRelatedPaginatedResponseDto" } } } }, "400": { "description": "The server could not understand the request due to invalid syntax." }, "401": { "description": "Access to the resource is unauthorized." }, "403": { "description": "Access to the resource is forbidden." }, "404": { "description": "Resource not found." }, "429": { "description": "Returned when the rate limit has been exceeded." }, "500": { "description": "Returned when a server operation fails in an unexpected way." }, "503": { "description": "Returned when the service is temporarily or expectedly unavailable." }, "default": { "description": "The list of related entities, plus pagination metadata.", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListAssetRelatedPaginatedResponseDto" } } } } }, "tags": \[ "relationship" \] } }, "/v1/relationships/finding/{id}/entities": { "get": { "operationId": "RelationshipController_listEntitiesRelatedToFinding", "parameters": \[ { "name": "id", "required": true, "in": "path", "description": "The id of the finding to retrieve related entities for.", "schema": { "format": "uuid", "type": "string" } }, { "name": "pageSize", "required": false, "in": "query", "description": "Max number of items to return from the database", "schema": { "default": 50, "type": "number" } }, { "name": "page", "required": false, "in": "query", "description": "Number of database items to skip", "schema": { "default": 1, "type": "number" } }, { "name": "sortBy", "required": false, "in": "query", "schema": { "default": "name", "enum": \[ "classification", "criticality", "display_name", "foundOn", "id", "lastSeenOn", "model", "name", "status", "type" \], "type": "string" } }, { "name": "sortOrder", "required": false, "in": "query", "schema": { "$ref": "#/components/schemas/OrderDirection" } }, { "name": "direction", "required": true, "in": "query", "schema": { "enum": \[ "in", "out" \], "type": "string" } }, { "name": "model", "required": false, "in": "query", "schema": { "enum": \[ "ASSET", "FINDING" \], "type": "string" } }, { "name": "class", "required": false, "in": "query", "schema": { "enum": \[ "CONTAINER", "DEVICE", "FRAMEWORK", "NETSTAT", "PERSON", "PROCESS", "SERVICE", "SOFTWARE", "SOURCE", "SURVEY", "USER", "ALERT", "EVENT", "INCIDENT" \], "type": "string" } }, { "name": "type", "required": false, "in": "query", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListFindingRelatedPaginatedResponseDto" } } } }, "400": { "description": "The server could not understand the request due to invalid syntax." }, "401": { "description": "Access to the resource is unauthorized." }, "403": { "description": "Access to the resource is forbidden." }, "404": { "description": "Resource not found." }, "429": { "description": "Returned when the rate limit has been exceeded." }, "500": { "description": "Returned when a server operation fails in an unexpected way." }, "503": { "description": "Returned when the service is temporarily or expectedly unavailable." }, "default": { "description": "The list of related entities, plus pagination metadata.", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListFindingRelatedPaginatedResponseDto" } } } } }, "tags": \[ "relationship" \] } }, "/v1/tags/{id}": { "get": { "operationId": "TagController_get", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/TagResponseDto" } } } } }, "tags": \[ "tag" \] }, "put": { "operationId": "TagController_update", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UpdateTagRequestBodyDto" } } } }, "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/TagResponseDto" } } } } }, "tags": \[ "tag" \] }, "delete": { "operationId": "TagController_delete", "parameters": \[ { "name": "id", "required": true, "in": "path", "schema": { "type": "string" } } \], "responses": { "200": { "description": "" } }, "tags": \[ "tag" \] } }, "/v1/tags": { "get": { "operationId": "TagController_list", "parameters": \[ { "name": "pageSize", "required": false, "in": "query", "description": "Max number of items to return from the database", "schema": { "default": 50, "type": "number" } }, { "name": "page", "required": false, "in": "query", "description": "Number of database items to skip", "schema": { "default": 1, "type": "number" } }, { "name": "search", "required": false, "in": "query", "description": "Search string to query on all data from tags", "schema": { "type": "string" } } \], "responses": { "200": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ListTagsPaginatedResponseDto" } } } } }, "tags": \[ "tag" \] }, "post": { "operationId": "TagController_create", "parameters": \[\], "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CreateTagRequestBodyDto" } } } }, "responses": { "201": { "description": "", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/TagResponseDto" } } } } }, "tags": \[ "tag" \] } } }, "info": { "title": "craft-service-swagger", "description": "Blackpoint craft service swagger spec and client", "version": "0.0.17", "contact": {} }, "tags": \[\], "servers": \[\], "components": { "schemas": { "AssetTag": { "type": "object", "properties": { "id": { "type": "string", "description": "The unique ID of the tag that is applied to the asset." }, "name": { "type": "string", "description": "The name of the tag." }, "customerId": { "type": "string", "description": "A tag must contain exactly one of either accountId or customerId" }, "accountId": { "type": "string", "description": "A tag must contain exactly one of either accountId or customerId" }, "createdBy": { "type": "string" }, "createdOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "id", "name", "createdBy", "createdOn" \] }, "ContainerResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "CONTAINER" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "command": { "type": "string", "nullable": true }, "containerId": { "type": "string", "nullable": true }, "ports": { "nullable": true, "type": "array", "items": { "type": "string" } }, "imageTag": { "type": "string", "nullable": true }, "image": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "DeviceResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "DEVICE" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "byod": { "type": "boolean", "nullable": true }, "encrypted": { "type": "boolean", "nullable": true }, "fqdns": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hardwareModel": { "type": "string", "nullable": true }, "hardwareVendor": { "type": "string", "nullable": true }, "hardwareVersion": { "type": "string", "nullable": true }, "hostname": { "type": "string", "nullable": true }, "platform": { "type": "string", "nullable": true }, "osName": { "type": "string", "nullable": true }, "osDetails": { "type": "string", "nullable": true }, "osVersion": { "type": "string", "nullable": true }, "ips": { "nullable": true, "type": "array", "items": { "type": "string" } }, "macs": { "nullable": true, "type": "array", "items": { "type": "string" } }, "osUpdatesEnabled": { "type": "boolean", "nullable": true }, "windowsDefenderEnabled": { "type": "boolean", "nullable": true }, "malwareProtected": { "type": "boolean", "nullable": true }, "publicIps": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hardwareSerial": { "type": "string", "nullable": true }, "location": { "type": "string", "nullable": true }, "firewallEnabled": { "type": "boolean", "nullable": true }, "remoteAccessEnabled": { "type": "boolean", "nullable": true }, "screenLockEnabled": { "type": "boolean", "nullable": true }, "screenLockTimeout": { "type": "number", "nullable": true, "minimum": 0 } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "FrameworkResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "FRAMEWORK" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "compliance": { "type": "boolean", "nullable": true }, "security": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "NetstatResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "NETSTAT" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "application": { "type": "string", "nullable": true }, "localAddress": { "type": "string", "nullable": true }, "offloadState": { "type": "string", "nullable": true }, "pid": { "type": "number", "nullable": true, "minimum": 0 }, "protocol": { "type": "string", "nullable": true }, "remoteAddress": { "type": "string", "nullable": true }, "user": { "type": "string", "nullable": true }, "state": { "type": "string", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "PersonResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "PERSON" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "address": { "type": "string", "nullable": true }, "csuite": { "type": "boolean", "nullable": true }, "email": { "type": "string", "nullable": true }, "emailDomain": { "type": "string", "nullable": true }, "employeeType": { "type": "string", "nullable": true }, "lastName": { "type": "string", "nullable": true }, "middleName": { "type": "string", "nullable": true }, "firstName": { "type": "string", "nullable": true }, "employee": { "type": "boolean", "nullable": true }, "employeeId": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true }, "title": { "type": "string", "nullable": true }, "phone": { "type": "string", "nullable": true }, "exitedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "ProcessResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "PROCESS" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "excludedUser": { "type": "string", "nullable": true }, "pid": { "type": "number", "nullable": true, "minimum": 0 }, "ppid": { "type": "number", "nullable": true, "minimum": 0 }, "userName": { "type": "string", "nullable": true }, "hash": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "ServiceResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SERVICE" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "urls": { "nullable": true, "type": "array", "items": { "type": "string" } }, "function": { "type": "string", "nullable": true }, "hosted": { "type": "boolean", "nullable": true }, "managed": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "SoftwareResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SOFTWARE" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "cots": { "type": "boolean", "nullable": true }, "fedramp": { "type": "boolean", "nullable": true }, "foss": { "type": "boolean", "nullable": true }, "function": { "type": "string", "nullable": true }, "version": { "type": "string", "nullable": true }, "ports": { "nullable": true, "type": "array", "items": { "type": "number" } }, "license": { "type": "string", "nullable": true }, "repoUrl": { "type": "string", "nullable": true }, "internal": { "type": "boolean", "nullable": true }, "urls": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hipaa": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "SourceResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SOURCE" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "SurveyResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SURVEY" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "surveyId": { "type": "string" }, "surveyedOn": { "format": "date-time", "type": "string" }, "surveyedBy": { "type": "string" } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "UserResponseDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "USER" }, "id": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "email": { "type": "string" }, "emailDomain": { "type": "string" }, "username": { "type": "string" }, "group": { "type": "string", "nullable": true }, "admin": { "type": "boolean", "nullable": true }, "mfaEnabled": { "type": "boolean", "nullable": true }, "mfaType": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "id", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags", "email", "emailDomain", "username" \] }, "CreateContainerDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "CONTAINER" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "command": { "type": "string", "nullable": true }, "containerId": { "type": "string", "nullable": true }, "ports": { "nullable": true, "type": "array", "items": { "type": "string" } }, "imageTag": { "type": "string", "nullable": true }, "image": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateDeviceDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "DEVICE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "byod": { "type": "boolean", "nullable": true }, "encrypted": { "type": "boolean", "nullable": true }, "fqdns": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hardwareModel": { "type": "string", "nullable": true }, "hardwareVendor": { "type": "string", "nullable": true }, "hardwareVersion": { "type": "string", "nullable": true }, "hostname": { "type": "string", "nullable": true }, "platform": { "type": "string", "nullable": true }, "osName": { "type": "string", "nullable": true }, "osDetails": { "type": "string", "nullable": true }, "osVersion": { "type": "string", "nullable": true }, "ips": { "nullable": true, "type": "array", "items": { "type": "string" } }, "macs": { "nullable": true, "type": "array", "items": { "type": "string" } }, "osUpdatesEnabled": { "type": "boolean", "nullable": true }, "windowsDefenderEnabled": { "type": "boolean", "nullable": true }, "malwareProtected": { "type": "boolean", "nullable": true }, "publicIps": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hardwareSerial": { "type": "string", "nullable": true }, "location": { "type": "string", "nullable": true }, "firewallEnabled": { "type": "boolean", "nullable": true }, "remoteAccessEnabled": { "type": "boolean", "nullable": true }, "screenLockEnabled": { "type": "boolean", "nullable": true }, "screenLockTimeout": { "type": "number", "nullable": true, "minimum": 0 } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateFrameworkDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "FRAMEWORK" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "compliance": { "type": "boolean", "nullable": true }, "security": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateNetstatDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "NETSTAT" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "application": { "type": "string", "nullable": true }, "localAddress": { "type": "string", "nullable": true }, "offloadState": { "type": "string", "nullable": true }, "pid": { "type": "number", "nullable": true, "minimum": 0 }, "protocol": { "type": "string", "nullable": true }, "remoteAddress": { "type": "string", "nullable": true }, "user": { "type": "string", "nullable": true }, "state": { "type": "string", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreatePersonDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "PERSON" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "address": { "type": "string", "nullable": true }, "csuite": { "type": "boolean", "nullable": true }, "email": { "type": "string", "nullable": true }, "emailDomain": { "type": "string", "nullable": true }, "employeeType": { "type": "string", "nullable": true }, "lastName": { "type": "string", "nullable": true }, "middleName": { "type": "string", "nullable": true }, "firstName": { "type": "string", "nullable": true }, "employee": { "type": "boolean", "nullable": true }, "employeeId": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true }, "title": { "type": "string", "nullable": true }, "phone": { "type": "string", "nullable": true }, "exitedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateProcessDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "PROCESS" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "excludedUser": { "type": "string", "nullable": true }, "pid": { "type": "number", "nullable": true, "minimum": 0 }, "ppid": { "type": "number", "nullable": true, "minimum": 0 }, "userName": { "type": "string", "nullable": true }, "hash": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateServiceDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SERVICE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "urls": { "nullable": true, "type": "array", "items": { "type": "string" } }, "function": { "type": "string", "nullable": true }, "hosted": { "type": "boolean", "nullable": true }, "managed": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateSoftwareDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SOFTWARE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "cots": { "type": "boolean", "nullable": true }, "fedramp": { "type": "boolean", "nullable": true }, "foss": { "type": "boolean", "nullable": true }, "function": { "type": "string", "nullable": true }, "version": { "type": "string", "nullable": true }, "ports": { "nullable": true, "type": "array", "items": { "type": "number" } }, "license": { "type": "string", "nullable": true }, "repoUrl": { "type": "string", "nullable": true }, "internal": { "type": "boolean", "nullable": true }, "urls": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hipaa": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateSourceDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SOURCE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateSurveyDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SURVEY" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "surveyId": { "type": "string" }, "surveyedBy": { "type": "string" }, "surveyedOn": { "format": "date-time", "type": "string" } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags" \] }, "CreateUserDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "USER" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "username": { "type": "string" }, "email": { "type": "string" }, "emailDomain": { "type": "string" }, "group": { "type": "string", "nullable": true }, "admin": { "type": "boolean", "nullable": true }, "mfaEnabled": { "type": "boolean", "nullable": true }, "mfaType": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass", "accountId", "customerId", "lastSeenOn", "name", "status", "foundOn", "tags", "username", "email", "emailDomain" \] }, "CreateAssetRequestBodyDto": { "type": "object", "properties": { "asset": { "oneOf": \[ { "$ref": "#/components/schemas/CreateContainerDto" }, { "$ref": "#/components/schemas/CreateDeviceDto" }, { "$ref": "#/components/schemas/CreateFrameworkDto" }, { "$ref": "#/components/schemas/CreateNetstatDto" }, { "$ref": "#/components/schemas/CreatePersonDto" }, { "$ref": "#/components/schemas/CreateProcessDto" }, { "$ref": "#/components/schemas/CreateServiceDto" }, { "$ref": "#/components/schemas/CreateSoftwareDto" }, { "$ref": "#/components/schemas/CreateSourceDto" }, { "$ref": "#/components/schemas/CreateSurveyDto" }, { "$ref": "#/components/schemas/CreateUserDto" } \] } }, "required": \[ "asset" \] }, "PartialCreateContainerDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "CONTAINER" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "command": { "type": "string", "nullable": true }, "containerId": { "type": "string", "nullable": true }, "ports": { "nullable": true, "type": "array", "items": { "type": "string" } }, "imageTag": { "type": "string", "nullable": true }, "image": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass" \] }, "PartialCreateDeviceDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "DEVICE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "byod": { "type": "boolean", "nullable": true }, "encrypted": { "type": "boolean", "nullable": true }, "fqdns": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hardwareModel": { "type": "string", "nullable": true }, "hardwareVendor": { "type": "string", "nullable": true }, "hardwareVersion": { "type": "string", "nullable": true }, "hostname": { "type": "string", "nullable": true }, "platform": { "type": "string", "nullable": true }, "osName": { "type": "string", "nullable": true }, "osDetails": { "type": "string", "nullable": true }, "osVersion": { "type": "string", "nullable": true }, "ips": { "nullable": true, "type": "array", "items": { "type": "string" } }, "macs": { "nullable": true, "type": "array", "items": { "type": "string" } }, "osUpdatesEnabled": { "type": "boolean", "nullable": true }, "windowsDefenderEnabled": { "type": "boolean", "nullable": true }, "malwareProtected": { "type": "boolean", "nullable": true }, "publicIps": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hardwareSerial": { "type": "string", "nullable": true }, "location": { "type": "string", "nullable": true }, "firewallEnabled": { "type": "boolean", "nullable": true }, "remoteAccessEnabled": { "type": "boolean", "nullable": true }, "screenLockEnabled": { "type": "boolean", "nullable": true }, "screenLockTimeout": { "type": "number", "nullable": true, "minimum": 0 } }, "required": \[ "assetClass" \] }, "PartialCreateFrameworkDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "FRAMEWORK" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "compliance": { "type": "boolean", "nullable": true }, "security": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass" \] }, "PartialCreateNetstatDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "NETSTAT" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "application": { "type": "string", "nullable": true }, "localAddress": { "type": "string", "nullable": true }, "offloadState": { "type": "string", "nullable": true }, "pid": { "type": "number", "nullable": true, "minimum": 0 }, "protocol": { "type": "string", "nullable": true }, "remoteAddress": { "type": "string", "nullable": true }, "user": { "type": "string", "nullable": true }, "state": { "type": "string", "nullable": true } }, "required": \[ "assetClass" \] }, "PartialCreatePersonDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "PERSON" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "address": { "type": "string", "nullable": true }, "csuite": { "type": "boolean", "nullable": true }, "email": { "type": "string", "nullable": true }, "emailDomain": { "type": "string", "nullable": true }, "employeeType": { "type": "string", "nullable": true }, "lastName": { "type": "string", "nullable": true }, "middleName": { "type": "string", "nullable": true }, "firstName": { "type": "string", "nullable": true }, "employee": { "type": "boolean", "nullable": true }, "employeeId": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true }, "title": { "type": "string", "nullable": true }, "phone": { "type": "string", "nullable": true }, "exitedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass" \] }, "PartialCreateProcessDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "PROCESS" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "excludedUser": { "type": "string", "nullable": true }, "pid": { "type": "number", "nullable": true, "minimum": 0 }, "ppid": { "type": "number", "nullable": true, "minimum": 0 }, "userName": { "type": "string", "nullable": true }, "hash": { "type": "string", "nullable": true }, "startedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "assetClass" \] }, "PartialCreateServiceDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SERVICE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "urls": { "nullable": true, "type": "array", "items": { "type": "string" } }, "function": { "type": "string", "nullable": true }, "hosted": { "type": "boolean", "nullable": true }, "managed": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass" \] }, "PartialCreateSoftwareDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SOFTWARE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "cots": { "type": "boolean", "nullable": true }, "fedramp": { "type": "boolean", "nullable": true }, "foss": { "type": "boolean", "nullable": true }, "function": { "type": "string", "nullable": true }, "version": { "type": "string", "nullable": true }, "ports": { "nullable": true, "type": "array", "items": { "type": "number" } }, "license": { "type": "string", "nullable": true }, "repoUrl": { "type": "string", "nullable": true }, "internal": { "type": "boolean", "nullable": true }, "urls": { "nullable": true, "type": "array", "items": { "type": "string" } }, "hipaa": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass" \] }, "PartialCreateSourceDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SOURCE" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } } }, "required": \[ "assetClass" \] }, "PartialCreateSurveyDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "SURVEY" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "surveyId": { "type": "string" }, "surveyedBy": { "type": "string" }, "surveyedOn": { "format": "date-time", "type": "string" } }, "required": \[ "assetClass" \] }, "PartialCreateUserDto": { "type": "object", "properties": { "assetClass": { "type": "string", "default": "USER" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string" }, "type": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } }, "username": { "type": "string" }, "email": { "type": "string" }, "emailDomain": { "type": "string" }, "group": { "type": "string", "nullable": true }, "admin": { "type": "boolean", "nullable": true }, "mfaEnabled": { "type": "boolean", "nullable": true }, "mfaType": { "type": "boolean", "nullable": true } }, "required": \[ "assetClass" \] }, "UpdateAssetRequestBodyDto": { "type": "object", "properties": { "asset": { "oneOf": \[ { "$ref": "#/components/schemas/CreateContainerDto" }, { "$ref": "#/components/schemas/CreateDeviceDto" }, { "$ref": "#/components/schemas/CreateFrameworkDto" }, { "$ref": "#/components/schemas/CreateNetstatDto" }, { "$ref": "#/components/schemas/CreatePersonDto" }, { "$ref": "#/components/schemas/CreateProcessDto" }, { "$ref": "#/components/schemas/CreateServiceDto" }, { "$ref": "#/components/schemas/CreateSoftwareDto" }, { "$ref": "#/components/schemas/CreateSourceDto" }, { "$ref": "#/components/schemas/CreateSurveyDto" }, { "$ref": "#/components/schemas/CreateUserDto" } \] } }, "required": \[ "asset" \] }, "OrderDirection": { "type": "string", "enum": \[ "ASC", "DESC" \] }, "Asset": { "type": "object", "properties": { "id": { "type": "string" }, "assetClass": { "type": "string", "enum": \[ "CONTAINER", "DEVICE", "FRAMEWORK", "NETSTAT", "PERSON", "PROCESS", "SERVICE", "SOFTWARE", "SOURCE", "SURVEY", "USER" \] }, "classification": { "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "type": { "type": "string", "nullable": true }, "accountId": { "type": "string" }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "model": { "type": "string" }, "summary": { "type": "string", "nullable": true }, "status": { "type": "string" }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "tags": { "type": "array", "items": { "$ref": "#/components/schemas/AssetTag" } } }, "required": \[ "id", "assetClass", "name", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "status", "tags" \] }, "ListAssetsPaginatedResponseDto": { "type": "object", "properties": { "data": { "description": "Items returned from the database", "discriminator": { "mapping": { "CONTAINER": "#/components/schemas/ContainerResponseDto", "DEVICE": "#/components/schemas/DeviceResponseDto", "FRAMEWORK": "#/components/schemas/FrameworkResponseDto", "NETSTAT": "#/components/schemas/NetstatResponseDto", "PERSON": "#/components/schemas/PersonResponseDto", "PROCESS": "#/components/schemas/ProcessResponseDto", "SERVICE": "#/components/schemas/ServiceResponseDto", "SOFTWARE": "#/components/schemas/SoftwareResponseDto", "SOURCE": "#/components/schemas/SourceResponseDto", "SURVEY": "#/components/schemas/SurveyResponseDto", "USER": "#/components/schemas/UserResponseDto" }, "propertyName": "assetClass" }, "type": "array", "items": { "oneOf": \[ { "$ref": "#/components/schemas/ContainerResponseDto" }, { "$ref": "#/components/schemas/DeviceResponseDto" }, { "$ref": "#/components/schemas/FrameworkResponseDto" }, { "$ref": "#/components/schemas/NetstatResponseDto" }, { "$ref": "#/components/schemas/PersonResponseDto" }, { "$ref": "#/components/schemas/ProcessResponseDto" }, { "$ref": "#/components/schemas/ServiceResponseDto" }, { "$ref": "#/components/schemas/SoftwareResponseDto" }, { "$ref": "#/components/schemas/SourceResponseDto" }, { "$ref": "#/components/schemas/SurveyResponseDto" }, { "$ref": "#/components/schemas/UserResponseDto" } \] } } }, "required": \[ "data" \] }, "AssignTagsToAssetsRequestBodyDto": { "type": "object", "properties": { "tagIds": { "type": "array", "items": { "type": "string" } } }, "required": \[ "tagIds" \] }, "AlertResponseDto": { "type": "object", "properties": { "findingClass": { "type": "string", "default": "ALERT" }, "id": { "type": "string" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "updatedBy": { "type": "string", "nullable": true }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "impact": { "type": "string", "nullable": true }, "recommendation": { "type": "string", "nullable": true }, "score": { "type": "number", "nullable": true }, "severity": { "type": "string", "nullable": true } }, "required": \[ "findingClass", "id", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "name" \] }, "EventResponseDto": { "type": "object", "properties": { "findingClass": { "type": "string", "default": "EVENT" }, "id": { "type": "string" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "updatedBy": { "type": "string", "nullable": true }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true }, "action": { "type": "string", "nullable": true }, "dataset": { "type": "string", "nullable": true }, "eventCategory": { "type": "string", "nullable": true }, "eventType": { "type": "string", "nullable": true }, "hash": { "type": "string", "nullable": true }, "kind": { "type": "string", "nullable": true }, "threatTacticId": { "type": "string", "nullable": true }, "threatTacticName": { "type": "string", "nullable": true }, "threatTechniqueId": { "type": "string", "nullable": true }, "threatTechniqueName": { "type": "string", "nullable": true } }, "required": \[ "findingClass", "id", "accountId", "createdOn", "customerId", "foundOn", "lastSeenOn", "model", "name" \] }, "IncidentResponseDto": { "type": "object", "properties": { "accountId": { "type": "string" }, "class": { "type": "string", "default": "INCIDENT" }, "classification": { "type": "string", "nullable": true }, "createdBy": { "type": "string" }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "id": { "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "ticketId": { "type": "string", "nullable": true }, "ticketUrl": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "updatedBy": { "type": "string", "nullable": true }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "accountId", "class", "createdBy", "createdOn", "customerId", "foundOn", "id", "lastSeenOn", "model", "name", "ticketId", "ticketUrl" \] }, "CreateAlertDto": { "type": "object", "properties": { "findingClass": { "type": "string", "default": "ALERT" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "impact": { "type": "string", "nullable": true }, "recommendation": { "type": "string", "nullable": true }, "score": { "type": "number", "nullable": true }, "severity": { "type": "string", "nullable": true } }, "required": \[ "findingClass", "accountId", "customerId", "foundOn", "lastSeenOn", "model", "name" \] }, "CreateEventDto": { "type": "object", "properties": { "findingClass": { "type": "string", "default": "EVENT" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "action": { "type": "string", "nullable": true }, "dataset": { "type": "string", "nullable": true }, "eventCategory": { "type": "string", "nullable": true }, "eventType": { "type": "string", "nullable": true }, "hash": { "type": "string", "nullable": true }, "kind": { "type": "string", "nullable": true }, "threatTacticId": { "type": "string", "nullable": true }, "threatTacticName": { "type": "string", "nullable": true }, "threatTechniqueId": { "type": "string", "nullable": true }, "threatTechniqueName": { "type": "string", "nullable": true } }, "required": \[ "findingClass", "accountId", "customerId", "foundOn", "lastSeenOn", "model", "name" \] }, "CreateFindingRequestBodyDto": { "type": "object", "properties": { "finding": { "oneOf": \[ { "$ref": "#/components/schemas/CreateAlertDto" }, { "$ref": "#/components/schemas/CreateEventDto" } \] } }, "required": \[ "finding" \] }, "PartialCreateAlertDto": { "type": "object", "properties": { "findingClass": { "type": "string", "default": "ALERT" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "impact": { "type": "string", "nullable": true }, "recommendation": { "type": "string", "nullable": true }, "score": { "type": "number", "nullable": true }, "severity": { "type": "string", "nullable": true } }, "required": \[ "findingClass" \] }, "PartialCreateEventDto": { "type": "object", "properties": { "findingClass": { "type": "string", "default": "EVENT" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "action": { "type": "string", "nullable": true }, "dataset": { "type": "string", "nullable": true }, "eventCategory": { "type": "string", "nullable": true }, "eventType": { "type": "string", "nullable": true }, "hash": { "type": "string", "nullable": true }, "kind": { "type": "string", "nullable": true }, "threatTacticId": { "type": "string", "nullable": true }, "threatTacticName": { "type": "string", "nullable": true }, "threatTechniqueId": { "type": "string", "nullable": true }, "threatTechniqueName": { "type": "string", "nullable": true } }, "required": \[ "findingClass" \] }, "PartialIncidentDto": { "type": "object", "properties": { "findingClass": { "type": "string", "default": "INCIDENT" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "ticketId": { "type": "string", "nullable": true }, "ticketUrl": { "type": "string", "nullable": true } }, "required": \[ "findingClass" \] }, "UpdateFindingRequestBodyDto": { "type": "object", "properties": { "finding": { "oneOf": \[ { "$ref": "#/components/schemas/CreateAlertDto" }, { "$ref": "#/components/schemas/CreateEventDto" } \] } }, "required": \[ "finding" \] }, "Finding": { "type": "object", "properties": { "id": { "type": "string" }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "createdBy": { "type": "string", "nullable": true }, "createdOn": { "format": "date-time", "type": "string" }, "criticality": { "type": "number", "nullable": true }, "customerId": { "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "findingClass": { "type": "string", "enum": \[ "ALERT", "EVENT", "INCIDENT" \] }, "foundBy": { "type": "string", "nullable": true }, "foundOn": { "format": "date-time", "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true }, "lastSeenOn": { "format": "date-time", "type": "string" }, "model": { "type": "string" }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true }, "updatedBy": { "type": "string", "nullable": true }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "id", "accountId", "createdOn", "customerId", "findingClass", "foundOn", "lastSeenOn", "model", "name" \] }, "ListFindingsPaginatedResponseDto": { "type": "object", "properties": { "data": { "description": "Items returned from the database", "discriminator": { "mapping": { "ALERT": "#/components/schemas/AlertResponseDto", "EVENT": "#/components/schemas/EventResponseDto", "INCIDENT": "#/components/schemas/IncidentResponseDto" }, "propertyName": "findingClass" }, "type": "array", "items": { "oneOf": \[ { "$ref": "#/components/schemas/AlertResponseDto" }, { "$ref": "#/components/schemas/EventResponseDto" }, { "$ref": "#/components/schemas/IncidentResponseDto" } \] } } }, "required": \[ "data" \] }, "ListIncidentsPaginatedResponseDto": { "type": "object", "properties": { "data": { "description": "Items returned from the database", "type": "array", "items": { "$ref": "#/components/schemas/IncidentResponseDto" } } }, "required": \[ "data" \] }, "CreateIncidentRequestBodyDto": { "type": "object", "properties": { "alertsIds": { "type": "array", "items": { "type": "string" } }, "accountId": { "type": "string" }, "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "customerId": { "type": "string" }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "foundBy": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "ticketId": { "type": "string", "nullable": true }, "ticketUrl": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true } }, "required": \[ "alertsIds", "accountId", "customerId", "name", "ticketId", "ticketUrl" \] }, "UpdateIncidentRequestBodyDto": { "type": "object", "properties": { "classification": { "type": "string", "nullable": true }, "criticality": { "type": "number", "nullable": true, "minimum": 1, "maximum": 10 }, "description": { "type": "string", "nullable": true }, "displayName": { "type": "string", "nullable": true }, "lastSeenBy": { "type": "string", "nullable": true }, "name": { "type": "string" }, "notes": { "type": "string", "nullable": true }, "production": { "type": "boolean", "nullable": true }, "status": { "type": "string", "nullable": true }, "summary": { "type": "string", "nullable": true }, "ticketId": { "type": "string", "nullable": true }, "ticketUrl": { "type": "string", "nullable": true }, "type": { "type": "string", "nullable": true } }, "required": \[ "name", "ticketId", "ticketUrl" \] }, "relationshipStatus": { "type": "string", "enum": \[ "active", "closed", "inactive", "open", "suspended", "terminated" \] }, "relationshipType": { "type": "string", "enum": \[ "explicit", "implicit" \] }, "relationshipVerb": { "type": "string", "enum": \[ "connects", "has" \] }, "RelationshipCreateRequestDto": { "type": "object", "properties": { "accountId": { "type": "string", "format": "uuid" }, "createdBy": { "type": "string", "nullable": true, "format": "uuid" }, "customerId": { "type": "string", "format": "uuid" }, "foundBy": { "type": "string", "nullable": true, "format": "uuid" }, "foundOn": { "format": "date-time", "type": "string" }, "fromId": { "type": "string" }, "lastSeenBy": { "type": "string", "nullable": true, "format": "uuid" }, "lastSeenOn": { "format": "date-time", "type": "string" }, "status": { "nullable": true, "$ref": "#/components/schemas/relationshipStatus" }, "toId": { "type": "string" }, "type": { "nullable": true, "$ref": "#/components/schemas/relationshipType" }, "verb": { "$ref": "#/components/schemas/relationshipVerb" }, "weight": { "type": "integer", "nullable": true, "minimum": 0 } }, "required": \[ "accountId", "customerId", "foundOn", "fromId", "lastSeenOn", "status", "toId", "verb" \] }, "RelationshipReadResponseWithRelatedDto": { "type": "object", "properties": {} }, "RelationshipUpdateRequestDto": { "type": "object", "properties": { "lastSeenBy": { "type": "string", "nullable": true, "format": "uuid" }, "lastSeenOn": { "format": "date-time", "type": "string" }, "status": { "nullable": true, "$ref": "#/components/schemas/relationshipStatus" }, "type": { "nullable": true, "$ref": "#/components/schemas/relationshipType" }, "updatedBy": { "type": "string", "nullable": true, "format": "uuid" }, "verb": { "$ref": "#/components/schemas/relationshipVerb" }, "weight": { "type": "integer", "nullable": true, "minimum": 0 } }, "required": \[ "lastSeenOn", "status", "verb" \] }, "RelationshipDeleteRequestDto": { "type": "object", "properties": { "deletedBy": { "type": "string", "nullable": true, "format": "uuid" } } }, "PageMetaFieldsResponseConstraint": { "type": "object", "properties": { "currentPage": { "type": "number" }, "totalItems": { "type": "number" }, "totalPages": { "type": "number" }, "pageSize": { "type": "number" } }, "required": \[ "currentPage", "totalItems", "totalPages", "pageSize" \] }, "ListAssetRelatedPaginatedResponseDto": { "type": "object", "properties": { "data": { "type": "array", "items": { "oneOf": \[ { "$ref": "#/components/schemas/ContainerResponseDto" }, { "$ref": "#/components/schemas/DeviceResponseDto" }, { "$ref": "#/components/schemas/FrameworkResponseDto" }, { "$ref": "#/components/schemas/NetstatResponseDto" }, { "$ref": "#/components/schemas/PersonResponseDto" }, { "$ref": "#/components/schemas/ProcessResponseDto" }, { "$ref": "#/components/schemas/ServiceResponseDto" }, { "$ref": "#/components/schemas/SoftwareResponseDto" }, { "$ref": "#/components/schemas/SourceResponseDto" }, { "$ref": "#/components/schemas/SurveyResponseDto" }, { "$ref": "#/components/schemas/UserResponseDto" }, { "$ref": "#/components/schemas/AlertResponseDto" }, { "$ref": "#/components/schemas/EventResponseDto" }, { "$ref": "#/components/schemas/IncidentResponseDto" } \] } }, "meta": { "$ref": "#/components/schemas/PageMetaFieldsResponseConstraint" } }, "required": \[ "data", "meta" \] }, "ListFindingRelatedPaginatedResponseDto": { "type": "object", "properties": { "data": { "type": "array", "items": { "oneOf": \[ { "$ref": "#/components/schemas/ContainerResponseDto" }, { "$ref": "#/components/schemas/DeviceResponseDto" }, { "$ref": "#/components/schemas/FrameworkResponseDto" }, { "$ref": "#/components/schemas/NetstatResponseDto" }, { "$ref": "#/components/schemas/PersonResponseDto" }, { "$ref": "#/components/schemas/ProcessResponseDto" }, { "$ref": "#/components/schemas/ServiceResponseDto" }, { "$ref": "#/components/schemas/SoftwareResponseDto" }, { "$ref": "#/components/schemas/SourceResponseDto" }, { "$ref": "#/components/schemas/SurveyResponseDto" }, { "$ref": "#/components/schemas/UserResponseDto" }, { "$ref": "#/components/schemas/AlertResponseDto" }, { "$ref": "#/components/schemas/EventResponseDto" }, { "$ref": "#/components/schemas/IncidentResponseDto" } \] } }, "meta": { "$ref": "#/components/schemas/PageMetaFieldsResponseConstraint" } }, "required": \[ "data", "meta" \] }, "TagResponseDto": { "type": "object", "properties": { "name": { "type": "string" }, "customerId": { "type": "string", "description": "A tag must contain exactly one of either accountId or customerId" }, "accountId": { "type": "string", "description": "A tag must contain exactly one of either accountId or customerId" }, "createdBy": { "type": "string" }, "createdOn": { "format": "date-time", "type": "string" }, "deletedBy": { "type": "string", "nullable": true }, "deletedOn": { "format": "date-time", "type": "string", "nullable": true }, "id": { "type": "string" }, "updatedBy": { "type": "string", "nullable": true }, "updatedOn": { "format": "date-time", "type": "string", "nullable": true } }, "required": \[ "name", "createdBy", "createdOn", "id" \] }, "ListTagsPaginatedResponseDto": { "type": "object", "properties": { "data": { "description": "Items returned from the database", "type": "array", "items": { "$ref": "#/components/schemas/TagResponseDto" } } }, "required": \[ "data" \] }, "CreateTagRequestBodyDto": { "type": "object", "properties": { "name": { "type": "string" }, "customerId": { "type": "string", "description": "A tag must contain exactly one of either accountId or customerId" }, "accountId": { "type": "string", "description": "A tag must contain exactly one of either accountId or customerId" } }, "required": \[ "name" \] }, "UpdateTagRequestBodyDto": { "type": "object", "properties": { "name": { "type": "string" } }, "required": \[ "name" \] } } } }

```
```